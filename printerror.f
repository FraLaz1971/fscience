C *************************************************************************
      SUBROUTINE PRINTERROR(STATUS)

C  THIS SUBROUTINE PRINTS OUT THE DESCRIPTIVE TEXT CORRESPONDING TO THE
C  ERROR STATUS VALUE AND PRINTS OUT THE CONTENTS OF THE INTERNAL
C  ERROR MESSAGE STACK GENERATED BY FITSIO WHENEVER AN ERROR OCCURS.

      INTEGER STATUS
      CHARACTER ERRTEXT*30,ERRMESSAGE*80

C  CHECK IF STATUS IS OK (NO ERROR); IF SO, SIMPLY RETURN
      IF (STATUS .LE. 0)RETURN

C  THE FTGERR SUBROUTINE RETURNS A DESCRIPTIVE 30-CHARACTER TEXT STRING THAT
C  CORRESPONDS TO THE INTEGER ERROR STATUS NUMBER.  A COMPLETE LIST OF ALL
C  THE ERROR NUMBERS CAN BE FOUND IN THE BACK OF THE FITSIO USER'S GUIDE.
      CALL FTGERR(STATUS,ERRTEXT)
      PRINT *,'FITSIO ERROR STATUS =',STATUS,': ',ERRTEXT

C  FITSIO USUALLY GENERATES AN INTERNAL STACK OF ERROR MESSAGES WHENEVER
C  AN ERROR OCCURS.  THESE MESSAGES PROVIDE MUCH MORE INFORMATION ON THE
C  CAUSE OF THE PROBLEM THAN CAN BE PROVIDED BY THE SINGLE INTEGER ERROR
C  STATUS VALUE.  THE FTGMSG SUBROUTINE RETRIEVES THE OLDEST MESSAGE FROM
C  THE STACK AND SHIFTS ANY REMAINING MESSAGES ON THE STACK DOWN ONE
C  POSITION.  FTGMSG IS CALLED REPEATEDLY UNTIL A BLANK MESSAGE IS
C  RETURNED, WHICH INDICATES THAT THE STACK IS EMPTY.  EACH ERROR MESSAGE
C  MAY BE UP TO 80 CHARACTERS IN LENGTH.  ANOTHER SUBROUTINE, CALLED
C  FTCMSG, IS AVAILABLE TO SIMPLY CLEAR THE WHOLE ERROR MESSAGE STACK IN
C  CASES WHERE ONE IS NOT INTERESTED IN THE CONTENTS.
      CALL FTGMSG(ERRMESSAGE)
      DO WHILE (ERRMESSAGE .NE. ' ')
          PRINT *,ERRMESSAGE
          CALL FTGMSG(ERRMESSAGE)
      END DO
      END
